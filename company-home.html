<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±ÙƒØ© - Ø³Ù‡Ù„Ø§Øª</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
  <style>
    .filters{display:grid; grid-template-columns:2fr 1fr 1fr 1fr 1fr; gap:10px}
    @media (max-width: 900px){.filters{grid-template-columns:1fr 1fr}}
    @media (max-width: 560px){.filters{grid-template-columns:1fr}}
    /* Rotating subtitle text (light, subtle) */
  #rotatingText{display:inline-block; opacity:0; transform:translateY(6px); transition: opacity .35s ease, transform .35s ease; color:#334155; font-size:16px}
    #rotatingText.show{opacity:1; transform:translateY(0)}
  /* Nudge the main yellow card a bit lower under the header */
  .company-head{margin-top:12px}
    /* Company header: move logo to the left side */
    .company-head .avatar-pin{right:auto; left:8px; top:6px}
    .company-head .profile-head__info{padding-inline-end:12px; padding-inline-start:120px; text-align:right}
    .company-head h1{font-size:22px !important; margin:2px 0 4px !important}
    .company-head .profile-head__info .form-help{font-size:15px}
    @media (max-width: 560px){
      .company-head .profile-head__info{padding-inline-start:0}
    }
  </style>
</head>
<body class="center-header">
<header class="site-header">
  <div class="container">
    <div class="header-stack" style="display:flex; flex-direction:column; align-items:center; gap:6px">
      <div class="brand">Ø³Ù‡Ù„Ø§Øª</div>
      <div class="form-help" style="margin:6px 0 0 0">
        <span id="rotatingText" class="show">ØºØ·Ù‘Ù Ø§Ù„Ù…ÙƒØ§Ù† Ù‚Ø¨Ù„ Ù„Ø§ ÙŠÙˆÙ‚Ù Ø§Ù„Ø´ØºÙ„.</span>
      </div>
    </div>
  </div>
</header>
<main class="container">
  <section class="yellow-card company-head">
    <div class="profile-head" style="margin-bottom:12px">
  <img class="avatar-pin" src="search-employee.svg" alt="Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØ¸Ù" />
      <div class="profile-head__info">
  <h1 style="margin:6px 0 6px; font-size:20px; color:#0b1222">Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</h1>
        <div class="form-help" style="color:#334155">Ø§Ø¨Ø­Ø« ÙˆÙÙ„ØªØ± Ø§Ù„Ø¨Ø§Ø­Ø«ÙŠÙ† Ø¨Ø­Ø³Ø¨ Ø§Ù„ÙˆØ¸ÙŠÙØ© ÙˆØ§Ù„Ù…Ø¯ÙŠÙ†Ø© ÙˆØ§Ù„Ø¹Ù…Ø± ÙˆØ§Ù„Ø¬Ù†Ø³ÙŠØ©</div>
        
      </div>
    </div>
    <div class="filters">
      <input id="q" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø£Ùˆ Ø§Ù„Ø¬Ù†Ø³ÙŠØ©" />
      <select id="fJob">
        <option value="">Ø§Ù„ÙˆØ¸ÙŠÙØ©</option>
        <option>ÙƒØ§Ø´ÙŠØ±</option>
        <option>Ù…Ø­Ø§Ø³Ø¨</option>
        <option>Ø¨Ø§Ø¦Ø¹</option>
        <option>Ø³ÙƒØ±ØªÙŠØ±</option>
        <option>Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡</option>
        <option>Ø­Ø§Ø±Ø³ Ø£Ù…Ù†</option>
        <option>Ù†Ø§Ø¯Ù„</option>
        <option>Ø£ÙŠÙ‘Ù‡Ù…Ø§ Ø£Ø³Ø¨Ù‚</option>
      </select>
      <select id="fCity">
        <option value="">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>
        <option>Ø§Ù„Ø±ÙŠØ§Ø¶</option>
        <option>Ø¬Ø¯Ø©</option>
        <option>Ù…ÙƒØ©</option>
        <option>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©</option>
        <option>Ø§Ù„Ø¯Ù…Ø§Ù…</option>
        <option>Ø§Ù„Ø®Ø¨Ø±</option>
        <option>Ø¨Ø±ÙŠØ¯Ø©</option>
        <option>ØªØ¨ÙˆÙƒ</option>
        <option>Ø£Ø¨Ù‡Ø§</option>
        <option>Ø¬Ø§Ø²Ø§Ù†</option>
      </select>
      <input id="minAge" inputmode="numeric" maxlength="2" placeholder="Ø¹Ù…Ø± Ù…Ù†" />
      <input id="maxAge" inputmode="numeric" maxlength="2" placeholder="Ø¹Ù…Ø± Ø¥Ù„Ù‰" />
    </div>
  </section>

  <section style="margin-top:14px">
    <div id="resultsMeta" class="actions" style="justify-content:space-between; align-items:center; margin-bottom:8px">
      <div class="form-help" id="resultsCount">Ø§Ù„Ù†ØªØ§Ø¦Ø¬: 0</div>
      <button id="clearFilters" class="btn btn--secondary" type="button">Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±</button>
    </div>
    <div id="results" class="form-card"></div>
  </section>
</main>
<footer class="site-footer"><div class="container">Â© <span id="y"></span> Ø³Ù‡Ù„Ø§Øª</div></footer>
<script>
  document.getElementById('y').textContent = new Date().getFullYear();
  // Gate access: require prior company access approval
  try{
    const ok = localStorage.getItem('companyAccessOK') === 'true';
    if (!ok){
      alert('Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø´Ø±ÙƒØ§Øª ÙŠØªØ·Ù„Ø¨ Ø±Ù…Ø² Ø¯Ø®ÙˆÙ„. Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ùƒ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.');
      window.location.href = 'company-login.html';
    }
  }catch{}
  // Rotating short phrases under the brand in header (companies page)
  (function(){
    const phrases = [
      'ØºØ·Ù‘Ù Ø§Ù„Ù…ÙƒØ§Ù† Ù‚Ø¨Ù„ Ù„Ø§ ÙŠÙˆÙ‚Ù Ø§Ù„Ø´ØºÙ„.',
      'Ù„Ø§ ØªØ¶ÙŠØ¹ Ø§Ù„ÙˆÙ‚Øªâ€¦ Ù„Ù‚Ù Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù„ÙŠ ÙŠÙ†Ø§Ø³Ø¨Ùƒ Ø§Ù„Ø¢Ù†.',
      'Ø®Ø° Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ØŒ ÙˆØ®Ù„ÙŠ Ø§Ù„ÙØ±ÙŠÙ‚ ÙŠØ´ØªØºÙ„ Ø¨Ø«Ù‚Ø©.',
      'ÙƒÙ„ ÙˆØ¸ÙŠÙØ© ÙØ§Ø¶ÙŠØ© = ÙØ±ØµØ© Ù„Ø´Ø®Øµ Ø¬Ø§Ù‡Ø².',
      'Ø¯ÙˆØ± Ø¨Ø³Ø±Ø¹Ø©ØŒ ØºØ·Ù‘ Ø¨Ø³Ø±Ø¹Ø©.',
      'Ø´ØºÙ„Ùƒ ÙŠØ­ØªØ§Ø¬ Ø´Ø®Øµ Ù…Ø«Ù„Ù‡ØŸ Ù„Ù‚Ø§Ù‡ ÙÙŠ Ø³Ù‡Ù„Ø§Øª.',
      'Ù„Ø§ ØªØ®Ù„ÙŠ Ø§Ù„Ø´Ø§ØºØ± ÙŠØ·ÙˆÙ‘Ù„â€¦ Ø­Ù„Ù‘Ù‡ ÙÙŠ Ø¯Ù‚Ø§Ø¦Ù‚.',
      'Ø§Ø®ØªØµØ± Ø§Ù„Ù…Ø´ÙˆØ§Ø±ØŒ ÙˆÙ„Ù‚Ù Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù„ÙŠ ÙŠÙƒÙ…Ù„ ÙØ±ÙŠÙ‚Ùƒ.',
      'Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù‚ÙˆÙŠ ÙŠØ¨Ø¯Ø£ Ø¨Ø§Ø®ØªÙŠØ§Ø± Ø°ÙƒÙŠ.',
      'Ø´ÙˆÙ Ù…Ù† Ø§Ù„Ø¬Ø§Ù‡Ø² Ø§Ù„ÙŠÙˆÙ…ØŒ ÙˆØ§Ø¨Ø¯Ø£ Ø¨ÙƒØ±Ø©.',
      'ØºØ·Ù‘ Ø§Ù„ÙØ¬ÙˆØ© Ù‚Ø¨Ù„ Ù…Ø§ ØªÙƒØ¨Ø±.',
      'Ø®Ù„Ù‘ Ø§Ù„ÙƒÙØ§Ø¡Ø© ØªÙˆØµÙ„ Ù„Ùƒ Ø¨Ø¯Ù„ Ù…Ø§ ØªØ¯ÙˆØ± Ø¹Ù„ÙŠÙ‡Ø§.',
      'Ø§Ù„Ø´Ø®Øµ Ø§Ù„ØµØ­ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ØµØ­ = Ø¥Ù†Ø¬Ø§Ø² Ø£Ø³Ø±Ø¹.',
      'Ù„Ù‚Ù Ù…ÙˆØ¸ÙÙƒ Ø§Ù„Ø¬Ø§ÙŠ ÙÙŠ Ø¶ØºØ·Ø© Ø²Ø±.',
      'Ù„Ø§ ØªÙ†ØªØ¸Ø± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ†ØŒ Ø´ÙˆÙÙ‡Ù… Ø¨Ù†ÙØ³Ùƒ.',
      'ØºØ·Ù‘ Ù†Ù‚ØµÙƒ Ø¨ÙƒÙØ§Ø¡Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„ÙŠÙˆÙ….',
      'Ø®Ù„Ùƒ Ø£ÙˆÙ„ Ù…Ù† ÙŠÙƒØªØ´Ù Ø§Ù„Ù…ÙˆØ§Ù‡Ø¨ Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©.',
      'ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø© ØªØ£Ø®ÙŠØ± Ù…Ù…ÙƒÙ† ØªÙƒÙ„Ù‘ÙÙƒ Ø¥Ù†ØªØ§Ø¬.',
      'Ù„Ø§ ØªÙÙƒØ± ÙƒØ«ÙŠØ±â€¦ Ø³Ù‡Ù‘Ù„Ù‡Ø§ØŒ ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„ØªÙˆØ¸ÙŠÙ.',
      'Ø§ÙƒØªØ´ÙØŒ Ø§Ø®ØªØ§Ø±ØŒ ØºØ·Ù‘ÙŠ â€” Ø¨Ø®Ø·ÙˆØ§Øª Ø³Ù‡Ù„Ø§Øª.'
    ];
    const rot = document.getElementById('rotatingText');
    if(!rot) return;
    let i = 0;
    function cycle(){
      rot.classList.remove('show');
      setTimeout(()=>{
        rot.textContent = phrases[i % phrases.length];
        i++;
        rot.classList.add('show');
      }, 220);
    }
    setTimeout(()=>rot.classList.add('show'), 60);
  setInterval(cycle, 6000);
  })();
  const results = document.getElementById('results');
  const els = {
    q: document.getElementById('q'),
    job: document.getElementById('fJob'),
    city: document.getElementById('fCity'),
    minAge: document.getElementById('minAge'),
    maxAge: document.getElementById('maxAge')
  };
  const digits = (s)=> (s||'').replace(/[^0-9]/g,'');
  const countEl = document.getElementById('resultsCount');
  const clearBtn = document.getElementById('clearFilters');
  function clearFilters(){
    els.q.value=''; els.job.value=''; els.city.value=''; els.minAge.value=''; els.maxAge.value='';
    apply();
  }
  clearBtn.addEventListener('click', clearFilters);
  function render(list){
    if (!list || !list.length){ results.innerHTML = '<div class="form-help">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©</div>'; return; }
    results.innerHTML = '';
    for(const s of list){
      const card = document.createElement('div'); card.className='card';
      const img = document.createElement('img'); img.className='avatar'; img.src = s.photoUrl || 'jobseeker.jpg'; img.onerror = ()=>{ img.src='jobseeker-fallback.svg' };
      const box = document.createElement('div');
      const name = document.createElement('div'); name.style.fontWeight='800'; name.textContent = s.fullName || '';
      const help = document.createElement('div'); help.className='form-help';
      const bits=[]; if(s.city) bits.push(s.city); if(s.age) bits.push(s.age+' Ø³Ù†Ø©'); if(s.nationality) bits.push(s.nationality);
      help.textContent = bits.join(' â€¢ ');
      const jobs = document.createElement('div');
      if (Array.isArray(s.jobs)){
        for(const j of s.jobs){ const span=document.createElement('span'); span.className='chip-gray'; span.textContent=j; jobs.appendChild(span); }
      }
  const actions = document.createElement('div'); actions.className='actions'; actions.style.marginTop='8px';
  const view = document.createElement('a'); view.className='btn btn--primary'; view.textContent='Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù'; view.href='seeker-view.html?id=' + encodeURIComponent(s.id||'');
      actions.appendChild(view);
      box.append(name, help, jobs, actions);
      card.append(img, box); results.appendChild(card);
    }
  }
  function apply(){
    let arr=[]; try{ arr = JSON.parse(localStorage.getItem('seekers')||'[]'); }catch{}
    // Ensure each seeker has an id (for older saved data)
    const makeId = (keyStr) => { let h=0; for(const ch of (keyStr||'')){ h=((h<<5)-h)+ch.charCodeAt(0); h|=0;} return 's'+Math.abs(h); };
    let mutated = false;
    for (const s of arr){
      if (!s.id){ const key = s.email || s.phone || s.nationalId || s.fullName || Math.random().toString(36).slice(2); s.id = makeId(key); mutated = true; }
    }
    // If no seekers found, seed from active seekerProfile (registered before upsert logic)
    if (!arr.length){
      try{
        const p = JSON.parse(localStorage.getItem('seekerProfile')||'{}');
        if (p && (p.fullName || p.email || p.phone || p.nationalId)){
          const key = p.email || p.phone || p.nationalId || p.fullName;
          p.id = p.id || makeId(key);
          arr = [p];
          mutated = true;
        }
      }catch{}
    }
    if (mutated){ try{ localStorage.setItem('seekers', JSON.stringify(arr)); }catch{} }
    const q = (els.q.value||'').trim();
    const job = els.job.value||''; const city = els.city.value||'';
    const min = parseInt(digits(els.minAge.value)||'-1',10); const max = parseInt(digits(els.maxAge.value)||'999',10);
    const out = arr.filter(s=>{
      // text query over name/city/nationality
      if (q){ const txt=(s.fullName+' '+(s.city||'')+' '+(s.nationality||'')).toLowerCase(); if(!txt.includes(q.toLowerCase())) return false; }
      if (job){ if (!Array.isArray(s.jobs) || !s.jobs.includes(job)) return false; }
      if (city){ if (s.city!==city) return false; }
      const ageNum = parseInt((s.age||'').replace(/[^0-9]/g,''),10);
      if (!isNaN(min) && ageNum < min) return false;
      if (!isNaN(max) && ageNum > max) return false;
      return true;
    });
    // Update count and clear button state
    if (countEl) countEl.textContent = `Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ${out.length}`;
    const filtersActive = q || job || city || (els.minAge.value||'') || (els.maxAge.value||'');
    if (clearBtn) clearBtn.disabled = !filtersActive;
    render(out);
  }
  els.q.addEventListener('input', apply);
  els.job.addEventListener('change', apply);
  els.city.addEventListener('change', apply);
  els.minAge.addEventListener('input', apply);
  els.maxAge.addEventListener('input', apply);
  apply();
</script>
</body>
</html>